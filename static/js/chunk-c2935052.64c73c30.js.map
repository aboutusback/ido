{"version":3,"sources":["webpack:///./src/views/idoa/partner/index.vue","webpack:///./src/views/idoa/partner/index.vue?1c0a","webpack:///./src/views/idoa/partner/index.vue?adf3"],"names":["class","title","t","type","lists","item","index","key","user","substring","length","amount","noData","$t","allowMultiple","components","Header","setup","proxy","store","data","address","state","accounts","web3","provider","usdtContract","handleContract","backContract","initContract","eth","Contract","config","usdtAddress","handleAbi_a","HANDLE_a","backAddress","initData","userOrderFetch","ToastUserOrder","loading","duration","methods","userOrder","call","from","Number","ordersFetch","clear","$errorformat","orderid","ToastOrdersr","orders","leaderAddress","partnerFetch","ToastPartner","getGroupOrders","decimals","decimalsBACK","k","dividedBy","toFixed","push","val","refData","render","__scopeId"],"mappings":"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","file":"static/js/chunk-c2935052.64c73c30.js","sourcesContent":["<template>\r\n  <div class=\"container partner\">\r\n    <Header :title=\"t('index.我的團隊')\" type=\"back\"></Header>\r\n    <div class=\"content\">\r\n      <div class=\"lists\">\r\n        <div class=\"li\" v-for=\"(item,index) in lists\" :key=\"index\">\r\n          <div class=\"key\"> {{item.user.substring(0,10)}}...{{item.user.substring(item.user.length - 10, item.user.length)}}</div>\r\n          <div class=\"value flex-item\">{{t('index.支付')}}<span>{{item.amount}}</span> U</div>\r\n        </div>\r\n        <div v-if=\"noData\" class=\"noData\">{{$t('暫無更多數據')}}</div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n<script>\r\nimport Header from '@/components/Header'\r\nimport { reactive, toRefs, computed, watch, getCurrentInstance } from \"vue\";\r\nimport { useI18n } from \"vue-i18n\";\r\nimport { useStore } from \"vuex\";\r\n\r\nimport { config } from \"@/utils/config\";\r\nimport BigNumber from \"bignumber.js\";\r\nimport tokenAbi from \"@/utils/abi.json\";\r\nimport handleAbi_a from \"@/utils/handleAbi_a.json\";\r\nimport { Toast } from \"vant\";\r\nToast.allowMultiple();\r\nexport default {\r\n  components: {\r\n    Header\r\n  },\r\n  setup () {\r\n    const { proxy } = getCurrentInstance();\r\n    const store = useStore()\r\n    const { t } = useI18n()\r\n    const data = reactive({\r\n      t: t,\r\n      address: computed(() => store.state.accounts[0]),\r\n      web3: computed(() => store.state.provider),\r\n      usdtContract: null,\r\n      handleContract: null,\r\n      backContract: null,\r\n      lists: [],\r\n      noData: false,\r\n      initContract: () => {\r\n        data.usdtContract = new data.web3.eth.Contract(\r\n          tokenAbi,\r\n          config.usdtAddress\r\n        );\r\n        data.handleContract = new data.web3.eth.Contract(\r\n          handleAbi_a,\r\n          config.HANDLE_a\r\n        );\r\n        data.backContract = new data.web3.eth.Contract(\r\n          tokenAbi,\r\n          config.backAddress\r\n        );\r\n        data.initData()\r\n      },\r\n      initData: () => {\r\n        data.userOrderFetch()\r\n      },\r\n      userOrderFetch: async () => {\r\n        const ToastUserOrder = Toast.loading({\r\n          duration: 0\r\n        })\r\n        try {\r\n          let userOrder = await data.handleContract.methods.userOrder(data.address).call({\r\n            from: data.address\r\n          })\r\n          console.log('userOrder:', userOrder)\r\n          if (!Number(userOrder)) {\r\n            console.log('无订单')\r\n            data.noData = true\r\n          } else {\r\n            await data.ordersFetch(userOrder)\r\n          }\r\n          ToastUserOrder.clear()\r\n        } catch (error) {\r\n          ToastUserOrder.clear()\r\n          proxy.$errorformat(error)\r\n        }\r\n      },\r\n      ordersFetch: async (orderid) => {\r\n        const ToastOrdersr = Toast.loading({\r\n          duration: 0\r\n        })\r\n        try {\r\n          let orders = await data.handleContract.methods.orders(orderid).call({\r\n            from: data.address\r\n          })\r\n          console.log('orders:', orders)\r\n          let { leaderAddress } = orders\r\n          data.partnerFetch(leaderAddress)\r\n          ToastOrdersr.clear()\r\n        } catch (error) {\r\n          ToastOrdersr.clear()\r\n          proxy.$errorformat(error)\r\n        }\r\n      },\r\n      partnerFetch: async (leaderAddress) => {\r\n        const ToastPartner = Toast.loading({\r\n          duration: 0\r\n        })\r\n        try {\r\n          let getGroupOrders = await data.handleContract.methods.getGroupOrders(leaderAddress).call()\r\n          console.log('getGroupOrders:', getGroupOrders)\r\n          let lists = []\r\n          let decimalsBACK = await data.backContract.methods.decimals().call()\r\n          if (getGroupOrders.length) {\r\n            for (let k = 0; k < getGroupOrders.length; k++) {\r\n              try {\r\n                let orders = await data.handleContract.methods.orders(getGroupOrders[k]).call({\r\n                  from: data.address\r\n                })\r\n                orders.amount = new BigNumber(orders.amount).dividedBy(10 ** decimalsBACK).toFixed(4)\r\n                lists.push(orders)\r\n              } catch (error) {\r\n                proxy.$errorformat(error)\r\n              }\r\n            }\r\n          }\r\n          data.lists = lists\r\n          ToastPartner.clear()\r\n        } catch (error) {\r\n          ToastPartner.clear()\r\n          proxy.$errorformat(error)\r\n        }\r\n      },\r\n    })\r\n    if (data.address) {\r\n      data.initContract()\r\n    }\r\n    watch(() => data.address, (val) => {\r\n      if (val) {\r\n        data.initContract()\r\n      }\r\n    })\r\n    const refData = toRefs(data);\r\n    return {\r\n      ...refData\r\n    };\r\n  }\r\n}\r\n</script>\r\n<style lang=\"less\" scoped>\r\n.lists {\r\n  padding: 6px 16px 16px;\r\n  .li {\r\n    background: #1a202e;\r\n    border-radius: 8px;\r\n    padding: 11px 12px;\r\n    display: flex;\r\n    align-items: center;\r\n    &:not(:last-child) {\r\n      margin-bottom: 12px;\r\n    }\r\n\r\n    .key {\r\n      font-size: 13px;\r\n      font-family: PingFang SC;\r\n      font-weight: 500;\r\n      color: #ffffff;\r\n    }\r\n    .value {\r\n      font-size: 13px;\r\n      font-family: PingFang SC;\r\n      font-weight: 500;\r\n      color: #ffffff;\r\n      text-align: right;\r\n      span {\r\n        color: #ffae12;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n<style lang=\"less\">\r\n</style>\r\n","import { render } from \"./index.vue?vue&type=template&id=dc26c52c&scoped=true\"\nimport script from \"./index.vue?vue&type=script&lang=js\"\nexport * from \"./index.vue?vue&type=script&lang=js\"\n\nimport \"./index.vue?vue&type=style&index=0&id=dc26c52c&lang=less&scoped=true\"\nscript.render = render\nscript.__scopeId = \"data-v-dc26c52c\"\n\nexport default script","export * from \"-!../../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--10-oneOf-1-0!../../../../node_modules/css-loader/dist/cjs.js??ref--10-oneOf-1-1!../../../../node_modules/vue-loader-v16/dist/stylePostLoader.js!../../../../node_modules/postcss-loader/src/index.js??ref--10-oneOf-1-2!../../../../node_modules/less-loader/dist/cjs.js??ref--10-oneOf-1-3!../../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../../node_modules/vue-loader-v16/dist/index.js??ref--0-1!./index.vue?vue&type=style&index=0&id=dc26c52c&lang=less&scoped=true\""],"sourceRoot":""}